电子科技大学
https://www.uestc.edu.cn/

进度：10集
重新看：6集（帧的结构，信号冲突）


* 协议(protocol)
   - 一组控制数据通信的规则
   - 语法 syntax 语义 semantics 时序 timing
   - what how when

* OSI 参考模型(Open system interconnection 开放系统互连)
   - 是由 ISO 组织制定的参考模型
   - Reference Model 参考模型(这是一个 网络系统结构的概念模型)
   - 目的：使两个不同的系统能够通信，而不需要改变底层的硬件或软件逻辑
   - 层次
      7. Application(应用层)(传输单元为数据)
      6. Presentation(表现层)(传输单元为数据)
      5. Session(会话层)(传输单元为数据)
      4. Transport(传输层)(传输单元为报文段或数据段)
      3. Network(网络层)(传输单元为分组)
      2. Data Link(数据链路层)(传输单元为帧)
      1. Physical(物理层)
   - 层次的划分
      - 7~5 应用支持层(软件)
      - 4 传输层
      - 3 因特网
      - 2~1 网络接入层
 
   - 每一层对数据的处理
      - 协议数据单元 PDU(Protocol Data Unit)
      - 数据层除了加了一个头部信息外还加了一个 帧
      - 数据链路层 加了 帧(Frame)
      - 网络层 加了 分组(Packet)
      - 传输层 加了 数据段(Segment)

* 网络
   - LANs(局域网)
   - MANs(城域网)
   - WANs(广域网)

* 编址
   - 三种地址的分类
      - 物理地址
         - 通信节点
         - 节点所属LAN或WAN指定
         - LAN或WAN内唯一
         - 地址/硬件地址
         - 0x005.5D06.1418
         - 物理网络的地址特性是不一样的，但在所在的局域网或广域网内是唯一的
            - 物理地址往往在一个网络内经过解析后明确具体的主机
      - ip地址
         - 标识通信节点的网络连接
         - Internet指定
         - Internet内唯一
         - 网络地址
         - 202.115.12.34
      - 端口地址
         - 标识通信进程
         - 操作系统指定
         - 一台计算机的唯一
         - 21,23,25,80
         - 8080,10000
   - 目的地址的分类
      - 单播
         - 一个接收者，例如0x0005.5D06.1418, 202.115.12.34
      - 多播
         - 一组接收者，例如0x0100.5E00.0002，224.0.0.2
         - 多播地址的 前面必须是 0x0100.5E
      - 广播
         - 网络中的所有系统
         - 例如：0xFFFF.FFFF.FFFF，255.255.255.255

* TCP/IP 的版本
   - Version 4
      - 地址空间不足和低效率：32位的地址
      - 对服务质量和安全等方面支持较弱
   - Version 5
      - 基于OSI模型
      - 层次改变大，代价高，没有实际使用
   - Version 6
      - 仅改动了网络层协议：IPv6、ICMP
      - 扩大了地址空间：128位的地址
      - 改进了版本4的弱点

* 底层网络技术
   - 传输介质
   - 局域网
   - 交换
   - 广域网
   - 连接设备

* 传输介质
   - 有线介质 -- 导线管（导向媒体）
      - 双绞线
      - 同轴电缆
      - 光纤
   - 无线介质 -- 电磁波（非导向媒体）
      - 8 个频段
      - VLF LF MF HF VHF UHF SHF EHF
        3KHz 30KHz 300KHz 3MHz 30MHz 300MHz 3GHz 30GHz 300GHz

* 局域网
   - 允许一些独立设备在受限地理范围内彼此能够直接通信
   - 共享介质 -- 广播式
   - 实现此技术的三种方式
      - LAN技术                接入方法 地址bytes 速率bps           帧
      - Ethernet（以太网技术） CSMA/CD  6         10M,100M1000M,10G 数据帧
         - 是发送方监听信道是否被占用，没有占用则发送，否则一直等到未占用则发送
      - Token Ring             令版传递 6         4M,16M            数据帧，令牌帧，异常终止帧
      - FDDI                   令牌传递 2或6      100M              数据帧，令牌帧

* Ethernet 帧格式 ------------------ 重看第6集
   - Ethernet 封装（RFC 894）
      - 以太网的帧中的数据长为 [46,1500] 字节范围
       
* 交换
   - 互互用于广域网或城域网
   - 交换系统
      - 有多个输入和输出的“黑盒子”
      - 电路交换
         - 建立连接->数据传输->拆除连接（比如电话系统）
      - 分组交换
         - 数据报
            - A和B之间的数据传输，数据会分组而经过不同的路径到达终点，所以B接收到的数据顺序可能不一致，且中途可能产生数据丢失
         - 虚电路
            - A和B之间建立传输路线连接，然后传输数据，最后拆除连接
            - 与电路交换的区别
               1. 电路交换是整个数据的传输，可以说是以流的形式传输
               2. 分组交换是把数据以分组的形式为单位进行传输的
               3. 电路交换的路线是一条实实在在的物理性的电路，而虚电路的路线是一条逻辑上的电路
      - 报文交换
         - 根数据报的发送方式很相像，但是发送的是报文，以报文为单位发送的

* 广域网
   - 在一个很大的地理范围内提供数据，话音和视频信息的长距离传输
   - 交换网络 -- 点到点式
      - 电路交换，分组交换

* LAN vs. WAN
   - LAN 使用自己的通信设施
   - WAN 利用公用的，租用的或专用通信设施

* 连接设备
   - 设备介绍
      - 转发器 Repeater / 集线器 Hub
      - 网桥 Bridge / 交换机 Switch
      - 路由器 Router
      - 网关 Gateway
   - 功能介绍
      1. 转发器/集线器 作用是物理上的，且是对数据bit流的再生和放大传输（集线器和转发器的区别仅仅是端口的多少）
         - 只提供数据的物理传输，但是会影响带宽，对于局域网来说会影响广播
         - 在 物理层 发生数据传输
         ```
         A --- B -- 集线器 -- E --- F
            |                    |
            C                    H
         A B C E F H 共用一个带宽
         ```
      2. 网桥/交换机 都是基于机器内部的地址表进行数据转发操作或判决（网桥和交换器区别是，网桥是由软件决定的，交换机是由硬件决定的）
         - 还解决了多台设备在同一个物理连接上占用相同带宽的情况，网桥/交换机可以把带宽分开
         - 网桥/交换机 必须是在数据链路层上必须有公共的特性
         - 在 数据链路层 发生数据转发（且包含物理层）
         ```
         A --- B --  -- E --- F
                  |  |
                 交换机        
                  |  |
         C --- D --  -- G --- H
         A B C D 为一组 和 E F G H 一组 这两组共用一个带宽
         ```
      3. 路由器
         - 可以连接不同的网络性质的网络
         - 在网络层发生数据转发（且包含数据链路层，物理层）
      4. 网关
         - 往往处于不同协议栈的使用

* IP编址
   1. ip地址就是通用标识符
      - 唯一标识互联网上的主机或路由器
      - 路由器是用于连接不同的网络的
         - 所以路由器可以有多个ip地址
         - 因为连接的每一个网络接口而言都有一个ip地址
   2. 主机标识符
      - Name: 是什么，可读性强
      - Address: 在哪里，软件效率高
      - Route: 怎样到达
   3. IP 地址的分类
      - Ipv4 是 32 bit 二进制地址
         - 由 Network id + Host id 共同组成（即网络号和主机号共同组成）
      - Ipv4 的不同分类（以下会以 二进制 和 点分十进制表示）
         - A类 0 7位网络号 24 位主机号
            - 0.0.0.0 ~ 127.255.255.255
         - B类 10 14位网络号 16位主机号
            - 128.0.0.0 ~ 191.255.255.255 
         - C类 110 21位网络号 8位主机号
            - 192.0.0.0 ~ 223.255.255.255 
         - D类 1110 24位(Multicast) 一般用于多播使用
            - 224.0.0.0 ~ 239.255.255.255 
         - E类 11110 27位(Reserved) 一般用于实验使用
            - 240.0.0.0 ~ 255.255.255.255 
   4. 多接口设备
      - 多接口（多接口的计算机，也可能是路由器）
         - 可以连接到多个网络
         - 每个网络连接分配一个 ip 地址，可属于不同的类;
         - 对于多接口的计算机来说，可以连接到多个连接当中也可以连接到同一个网络当中
            - 对于计算机来说，连接到多个网络，多个网络之间不能进行通信，因为计算机只起到终端的作用
      - 路由器
         - 必须连接到多个网络
         - 每个网络连接分配一个ip地址，可属于不同的类
         - 路由器的多个接口不能连接到一个网络当中，只能接在不同的网络中，因为路由器的网络不明白走哪个接口
            - 虽然路由器的一个接口可以连接天朝不同的网络，但是不同的网络之间是不能互相通信的（这就是路由器的一个接口只能连到一个网络的原由）

   5. Netid（物理网络）
      - 每个ip 就是由 Netid+Hostid 组成的
      - 换句话说就是：ipv4是由 网络地址 + 主机号组成

   6. 特殊地址
      网络地址           Netid    Hostid 源/目的地址
      网络地址           特定的   全0    都不是
      直接广播地址       特定的主 全1    目的地址
      受限广播地址       全1      全1    目的地址
      本网络上的本主机   全0      全0    源地址
      本网络上的特定主机 全0      特定的 目的地址
      环回地址           127      任意   目的地址
   7. A 类地址很特殊，因为 本网络上的本主机，环回地址 其实就是占用了 A 类地址的两种情况
   8. 特定的：不是全0 也不是全1
      - 网络地址
         - Netid：特定的，Hostid：全为0
         - 表示一个网络
      - 直接广播地址（特定网络当中的所有主机）
         - Netid：特定的，Hostid：全为1 
         - 表示特定网络当中的所有主机
      - 受限广播地址（本地广播地址）
         - 255.255.255.255
         - 只在源以内的范围广播，并且这个网络到达了路由器就不会再把消息发送到其它网络了
            - 假设有两个网络 A 和 B 连在了 路由器上，那么 A 网络产生的一个 受限广播地址分组的信号 255.255.255，那么 A 网络和 路由器都会收到这个信息（但是路由器收到了之后并不会传送到 B，这符合 只在源以内的范围广播）
            - 这种方式和直接广播地址处理方式一样，注意两者的路由器在收到信号后并不会把信息重复再发送到源
            - 直接广播和受限广播的区别，作用一样，但是受限广播只限制在本网络里，而直接广播是对指定网络的广播
      - 本网络上的本主机
         - 0.0.0.0
         - 例如：设备A <--> 216.45.7.0 网络 <--> 216.45.7.126 引导服务器（DHCP Server）
            - 因为设备A要从 DHCP Server 中自动获取被分配的Ip地址，所以需要发送信号
            - 即 源：0.0.0.0 ，目的地址：255.255.255.255 这样引导服务器可以给予响应
      - 本网络上的特定主机
         - Netid 全0，并且 Hostid 非全0也非全1
         - 如果几台主机：216.45.7.20, 216.45.7.64, 216.45.7.126 和 A 主机
            - A 主机发送了信息 0.0.0.64给本网络，则信息会被发送到 216.45.7.64
      - 环回地址
         - 最前面的字节为 127，其它的部分特定值 例如：127.?.?.?
         - 案例
          应用层    process1  process2
          传输层       TCP or UDP
          网络层           IP
          链路层      Network Access
         - 如果一台主机发送了信号  127.?.?.? 那么数据从 Process1 发送到 TCP or UDP 再到IP
           那么信息会从 IP 层反向到 Process2，不会到达链路层，一般用户机器的软件测试，只会发生在机器自身，不会发生在网络上
   9. 路由器的一个接口接在两个 ip 网上的可能性
      - 例子1
         路由器 --- 交换机 ----- A
                    |    |
              C------    ------- B
              D-----|
              E-----|
         A和B一个网络，C和D和E一个网络
         尽管 这几台机器都在一个物理连接图上，但是逻辑网络不一样所以不能通信
      - 例子2（等效于例子1）
         C      路由器        A
         |_________|__________|
         |   |                |
         D   E                B
         AB一个网络，CDE一个网络，通信和例子1同理
      - 在一个以太网上，网络不同仍不能通信，*********** ip协议和ARP协议时会解释 ************
   10. 路由器的多个接口接在一个 ip 网络上的可能性
      - 是不可能的，原因是ip分组的选路：基于ip网络的选路的 
      - 路由器收到一个ip分组后，是根据ip网络选路的，如果多个接口接在同一个网络上，在选择的时候会有歧义        1. 是选择所有连接的接口都发送报文 2. 选择一个接口进行发送报文（以什么算法进行选择？）

   11. 这两种情况的可能与不可能的原因，因为：ip地址 -- 网络层，标识网络连接（这个网络连接是逻辑连接非物理连接）
      - 一个物理连接可以有多个逻辑连接，多个物理连接不能共用一个逻辑连接
   12. 单播，多播，广播
      - 单播(Unicast)
         - 通信：一对一，源或目的地址
         - 因特网上的所有系统必须至少有一个唯一的单播地址
         - 可以是 A, B ,C类网络
      - 多播(Multicast)
         - 通信：一对多，目的地址
         - 因特网上的系统可以有一个或多个多播地址
         - 是 D 类，本地级或全局级（本地级是一个网络内，全局级可以是多个不同的网络）
      - 广播(Broadcast)
         - 通信：一对所有，目的地址
         - 受限广播和直接广播，本地级（只能是一个网络内）
   13. 标识网络连接的ip地址数目
      - 对于 A 类网络，Netid 全0 表示本网络的本主机，Netid全1 表示环回地址 所以2^7-2
      - 类别      网络数           主机ip数/网络
         A        2^7-2 = 126       2^24-2 = 16777214
         B        2^14 = 16384    2^16-2 = 65534
         C        2^21 = 2097152    2^8-2 = 254  
   14. 专用网络
      - 不需要接入 Internet，但需要用 TCP/IP 通信
         - 编址方案
            - 申请，并使用 A, B, C 类地址（全局唯一）
            - 不申请，直接使用 A, B, C 类地址（本组织唯一，全局不唯一）
            - 不申请，直接使用专用地址（本组织唯一，全局不唯一）
         - Private address，私有地址（所以一般用 nat 技术把私有网络转换为全局ip进行请求）
            - A类 10.0.0.0 ~ 10.255.255.255          1 种网络地址
            - B类 172.16.0.0 ~ 172.31.255.255        16 种网络地址
            - C类 192.168.0.0 ~ 192.168.255.255      256 种 网络地址

* 构成子网和超网
   - Classful IP 编址的缺陷
      - C类 少于 255 台主机的网络
      - B类 介于 255 ~ 65535 台主机的网络
      - A类 超过 65535 台主机的网络
   - 解析原由
      - 假如有100台设备要组成一个全局网络，按最小网络ip损耗则该选B类网络，但是仍有上万个ip被浪费
      - 解决方案：采用无类 IP 编址（Classless IP）
         - 子网划分Subnetting
            - 概念
               - 将一个 IP 类网划分成几个较小的子网(subnet)
               - 多个物理网共享同一个IP类网前缀（即只根据Netid无法判断是否属于同一个网络内）
               - 形式：Netid+Hostid => Netid+Subnetid+Hostid（即把以前的Hostid分成了Subnetid 和 Hostid）
               - Subnetid 的长度是不固定的
            - 例子
               - 一个B类网络ip为 141.14.0.0 被划分成了三个子网
               - Subnet 141.14.2.0 
                  - 141.14.2.20
                  - 141.14.2.21
                  - 141.14.2.10                 
               - Subnet 141.14.7.0
                  - 141.14.7.45
                  - 141.14.7.44
                  - 141.14.7.96
               - Subnet 141.14.22.0
                  - 141.14.22.8
                  - 141.14.22.9
                  - 141.14.22.64
            - 子网掩码(Mask)
               - Subnetting
               - 更适合于物理网的实际大小
                  - 不能再用首字节判定网络大小
                  - 字节边界没有意义，仅用在点分十进制表示法中
               - 表示网络或子网的大小
                  - 32 bits 二进制数
                  - 1：网络(Netid)或子网(Netid+Subnetid)部分
                  - 0：主机部分(Hostid)





         - 超网划分Supernetting

   - A， B类浪费严重，少有上万台主机的大型IP网络
   - 构成子网
   - 掩码运算
   - 子网构成举例
   - 使用变长子网划分
   - 构成超网
